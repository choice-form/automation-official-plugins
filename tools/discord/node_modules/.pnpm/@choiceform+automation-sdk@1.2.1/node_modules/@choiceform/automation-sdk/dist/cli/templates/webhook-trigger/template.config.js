/**
 * Webhook Trigger æ¨¡æ¿é…ç½®
 */
export default {
  name: 'webhook-trigger',
  description: 'HTTP Webhook è§¦å‘å™¨ - å…¼å®¹ n8n é£æ ¼çš„å·¥ä½œæµè‡ªåŠ¨åŒ–ç³»ç»Ÿ',
  complexity: 'intermediate',
  features: ['http', 'webhook', 'trigger', 'api'],
  dependencies: ['nanoid'],
  devDependencies: ['@types/node'],
  
  // æ¨¡æ¿æ–‡ä»¶é…ç½®
  files: [
    {
      source: 'index.ts.mustache',
      target: 'index.ts',
      required: true
    },
    {
      source: 'registration.ts.mustache', 
      target: 'registration.ts',
      required: true
    },
    {
      source: 'types.ts.mustache',
      target: 'types/webhook.ts',
      required: false
    },
    {
      source: 'test.ts.mustache',
      target: 'tests/webhook-trigger.test.ts',
      required: false
    },
    {
      source: 'README.md.mustache',
      target: 'README.md',
      required: false
    }
  ],
  
  // æ¨¡æ¿å˜é‡ç”Ÿæˆå‡½æ•°
  generateTemplateData: (projectName, context) => {
    console.log('ğŸ”§ [TEMPLATE] generateTemplateData called with:', { projectName, context: typeof context });
    
    // ç”Ÿæˆåˆç†çš„ç±»åï¼šç»Ÿä¸€ä½¿ç”¨ WebhookTrigger
    const className = 'WebhookTrigger';
    
    // ç”Ÿæˆåˆç†çš„æ³¨å†Œåï¼šä½¿ç”¨ camelCase
    const registrationName = 'webhookTriggerRegistration';
    
    // ç”Ÿæˆåˆç†çš„é…ç½®æ¥å£å
    const configInterfaceName = 'WebhookTriggerConfig';
    const settingsInterfaceName = 'WebhookTriggerSettings';
    
    // ç”Ÿæˆå®‰å…¨çš„é¡¹ç›®å
    const safeProjectName = projectName
      .replace(/[^a-zA-Z0-9]/g, '') // ç§»é™¤æ‰€æœ‰éå­—æ¯æ•°å­—å­—ç¬¦
      .replace(/^[0-9]/, '_$&') // å¦‚æœä»¥æ•°å­—å¼€å¤´ï¼Œæ·»åŠ ä¸‹åˆ’çº¿
      .toLowerCase();
    
    const result = {
      projectName: projectName,
      className: className,
      registrationName: registrationName,
      configInterfaceName: configInterfaceName,
      settingsInterfaceName: settingsInterfaceName,
      safeProjectName: safeProjectName,
      description: context.description || 'HTTP Webhook è§¦å‘å™¨ - å…¼å®¹å·¥ä½œæµè‡ªåŠ¨åŒ–ç³»ç»Ÿ',
      author: context.author || 'developer',
      sdkPackageName: '@choiceform/automation-plugin-sdk'
    };
    
    console.log('ğŸ”§ [TEMPLATE] Generated data:', result);
    return result;
  }
}; 