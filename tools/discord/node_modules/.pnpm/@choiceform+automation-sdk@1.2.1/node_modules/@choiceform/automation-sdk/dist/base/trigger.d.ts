import { ExecutionContext, PluginValue, ExecutionResult } from '../types/index.js';
/**
 * è§¦å‘å™¨äº‹ä»¶ç±»å‹
 */
export interface TriggerEvent {
    data: PluginValue;
    id: string;
    metadata?: Record<string, PluginValue>;
    timestamp: number;
    type: string;
}
/**
 * è§¦å‘å™¨é…ç½®
 */
export interface TriggerConfig {
    enabled: boolean;
    settings: Record<string, PluginValue>;
}
/**
 * è§¦å‘å™¨çŠ¶æ€
 */
export declare enum TriggerStatus {
    ERROR = "error",
    RUNNING = "running",
    STARTING = "starting",
    STOPPED = "stopped",
    STOPPING = "stopping"
}
/**
 * è§¦å‘å™¨åŸºç¡€æŠ½è±¡ç±»
 * æ‰€æœ‰è§¦å‘å™¨æ’ä»¶éƒ½åº”è¯¥ç»§æ‰¿æ­¤ç±»
 *
 * é‡æ„åçš„è®¾è®¡ï¼š
 * 1. ç®€åŒ–æ¥å£ï¼Œå»é™¤å¤æ‚çš„ç»§æ‰¿å±‚æ¬¡
 * 2. ç¡®ä¿ä¸ NodeImplementation å®Œå…¨å…¼å®¹
 * 3. æä¾›æ¸…æ™°çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
 */
export declare abstract class Trigger {
    protected status: TriggerStatus;
    protected config: TriggerConfig;
    protected context?: ExecutionContext;
    /**
     * ğŸ”§ é‡æ„ï¼šå…¼å®¹ NodeImplementation æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•
     * @param context æ‰§è¡Œä¸Šä¸‹æ–‡
     */
    initialize(context: ExecutionContext): Promise<void>;
    /**
     * ğŸ”§ é‡æ„ï¼šä¸“ç”¨çš„é…ç½®åˆå§‹åŒ–æ–¹æ³•
     * @param config è§¦å‘å™¨é…ç½®
     * @param context æ‰§è¡Œä¸Šä¸‹æ–‡
     */
    initializeWithConfig(config: TriggerConfig, context: ExecutionContext): Promise<void>;
    /**
     * å¯åŠ¨è§¦å‘å™¨
     */
    start(): Promise<void>;
    /**
     * åœæ­¢è§¦å‘å™¨
     */
    stop(): Promise<void>;
    /**
     * æ›´æ–°é…ç½®
     * @param config æ–°é…ç½®
     */
    updateConfig(config: TriggerConfig): Promise<void>;
    /**
     * è·å–å½“å‰çŠ¶æ€
     */
    getStatus(): TriggerStatus;
    /**
     * è·å–å½“å‰é…ç½®
     */
    getConfig(): TriggerConfig;
    /**
     * è§¦å‘äº‹ä»¶
     * @param event è§¦å‘äº‹ä»¶
     */
    protected triggerEvent(event: TriggerEvent): Promise<void>;
    /**
     * å­ç±»éœ€è¦å®ç°çš„å¯åŠ¨æ–¹æ³•
     */
    protected abstract onStart(): Promise<void>;
    /**
     * å­ç±»éœ€è¦å®ç°çš„åœæ­¢æ–¹æ³•
     */
    protected abstract onStop(): Promise<void>;
    /**
     * å­ç±»éœ€è¦å®ç°çš„äº‹ä»¶å¤„ç†æ–¹æ³•
     * @param event è§¦å‘äº‹ä»¶
     */
    protected abstract onEvent(event: TriggerEvent): Promise<void>;
    /**
     * éªŒè¯é…ç½®
     * @param config é…ç½®å¯¹è±¡
     */
    protected validateConfig(_config: TriggerConfig): boolean;
    /**
     * å®‰å…¨åœ°è®°å½•æ—¥å¿—
     */
    protected log(level: 'info' | 'warn' | 'error', message: string): void;
    /**
     * å®‰å…¨åœ°è·å–å‡­æ®
     */
    protected getCredential(name: string): Promise<string | undefined>;
    /**
     * å®‰å…¨åœ°å­˜å‚¨æ•°æ®
     */
    protected storeData(key: string, value: PluginValue): Promise<void>;
    /**
     * å®‰å…¨åœ°æ£€ç´¢æ•°æ®
     */
    protected retrieveData(key: string): Promise<PluginValue | null>;
    /**
     * ğŸ”§ é‡æ„ï¼šç¡®ä¿ NodeImplementation æ¥å£å…¼å®¹æ€§
     *
     * å®ç° NodeImplementation æ¥å£è¦æ±‚çš„ execute æ–¹æ³•
     * å¯¹äºè§¦å‘å™¨ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºï¼š
     * 1. åˆå§‹åŒ–å’Œå¯åŠ¨è§¦å‘å™¨
     * 2. æ‰‹åŠ¨è§¦å‘æµ‹è¯•
     * 3. é…ç½®æ›´æ–°
     */
    execute(inputs: Record<string, PluginValue>, context: ExecutionContext): Promise<ExecutionResult>;
    /**
     * ğŸ”§ é‡æ„ï¼šæ·»åŠ é»˜è®¤çš„æ‰‹åŠ¨è§¦å‘æ–¹æ³•
     * å­ç±»å¯ä»¥é‡å†™æ­¤æ–¹æ³•å®ç°ç‰¹å®šçš„æ‰‹åŠ¨è§¦å‘é€»è¾‘
     */
    manualTrigger(): Promise<void>;
    /**
     * ğŸ”§ é‡æ„ï¼šåˆ›å»ºæˆåŠŸç»“æœçš„è¾…åŠ©æ–¹æ³•
     */
    protected createSuccessResult(data: Record<string, PluginValue>, metadata?: Record<string, PluginValue>): ExecutionResult;
    /**
     * ğŸ”§ é‡æ„ï¼šåˆ›å»ºé”™è¯¯ç»“æœçš„è¾…åŠ©æ–¹æ³•
     */
    protected createErrorResult(message: string, code?: string, details?: PluginValue): ExecutionResult;
}
